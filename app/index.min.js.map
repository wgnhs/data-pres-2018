{"version":3,"file":"index.min.js","sources":["../../app/filter/filter-controls.js","../../app/site-data.js","../../app/map/restyling-circle-marker.js","../../app/map/site-map.js","../../app/details/layout/table-layout.js","../../app/details/download-button.js","../../app/details/pdf-split-button.js","../../app/details/layout/log-layout.js","../../app/details/layout/core-layout.js","../../app/details/layout-resolver.js","../../app/details/site-details.js","../../app/filter/filter-summary.js","../../app/filter/map-filter.js","../../app/index.js"],"sourcesContent":["import { html } from 'lit-element';\nimport { genId } from 'wgnhs-common';\n\nexport class FilterGroup {\n  constructor(config) {\n    Object.assign(this, config);\n    if (!this.id) {\n      this.id = genId();\n    }\n  }\n  activate(context) {\n    let result = null;\n    const input = context.detail.checked;\n    if (context.toggleable && input) {\n      result = {\n        id: context.id,\n        context,\n        resolve: function(feature) {\n          return feature[context.prop] === context.value;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class CheckboxControl {\n  constructor() {\n    this.id = genId();\n  }\n  get next() {\n    return html`\n      <input type=\"checkbox\">\n    `;\n  }\n  handle(context) {\n    let result = null;\n\n    let input = context.target.nextElementSibling.checked;\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        context,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop]\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class GTLTControl {\n  constructor(isDate) {\n    this.id = genId();\n    this.gtName = (isDate)?'after':'at least';\n    this.eqName = (isDate)?'exactly':'equal to';\n    this.ltName = (isDate)?'before':'less than';\n  }\n  get next() {\n    return html`\n      <select>\n        <option value=\"gt\">${this.gtName}</option>\n        <option value=\"eq\">${this.eqName}</option>\n        <option value=\"lt\">${this.ltName}</option>\n      </select>\n      <input type=\"text\">\n    `;\n  }\n  handle(context) {\n    let result = null;\n    context['gt'] = (a, b) => (a >= b);\n    context['eq'] = (a, b) => (a == b);\n    context['lt'] = (a, b) => (a < b);\n\n    const predicate = context[context.target.nextElementSibling.value];\n    const input = context.target.nextElementSibling.nextElementSibling.value;\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        context,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop];\n          if (isValid) {\n            isValid = predicate(feature[context.prop], input);\n          }\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class SelectControl {\n  constructor() {\n    this.id = genId();\n  }\n  get next() {\n    return html`\n      <select ?disabled=\"${!this.options}\">\n        <option></option>\n        ${(!this.options)?'':this.options.map((el) => html`\n        <option value=\"${el}\">${el}</option>\n        `)}\n      </select>\n    `;\n  }\n  init(uniques) {\n    if (!this.options) {\n      this.options = Array.from(uniques).sort();\n    }\n  }\n  handle(context) {\n    let result = null;\n\n    const input = context.target.nextElementSibling.value;\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        context,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop];\n          if (isValid) {\n            const value = feature[context.prop]\n            isValid = value === input;\n          }\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class TextControl {\n  constructor() {\n    this.id = genId();\n  }\n  get next() {\n    return html`\n      <input type=\"text\">\n    `;\n  }\n  handle(context) {\n    let result = null;\n\n    const input = ('' + context.target.nextElementSibling.value).trim().toUpperCase();\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        context,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop];\n          if (isValid) {\n            const value = ('' + feature[context.prop]).trim().toUpperCase();\n            isValid = value === input;\n          }\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class ContainsControl {\n  constructor() {\n    this.id = genId();\n  }\n  get next() {\n    return html`\n      <input type=\"text\">\n    `;\n  }\n  handle(context) {\n    let result = null;\n\n    const input = ('' + context.target.nextElementSibling.value).trim().toUpperCase();\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        context,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop];\n          if (isValid) {\n            const value = ('' + feature[context.prop]).trim().toUpperCase();\n            isValid = value.includes(input);\n          }\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}","import {\n  FilterGroup,\n  CheckboxControl,\n  GTLTControl,\n  SelectControl,\n  TextControl,\n  ContainsControl\n} from './filter/filter-controls.js';\n\nexport class SiteData {\n  constructor(layers) {\n\n    // Define aggregated data for visualization\n    this._aggrKeys = [\n      'County',\n      'Drill_Method',\n      'Project'\n    ];\n    this.aggrData = [];\n    for (let l of layers) {\n      this.aggrData.push(SiteData._gatherAggrData(l, this._aggrKeys));\n    }\n\n    this.datas = this.aggrData.map((el)=>el.data).reduce((prev, curr)=>prev.concat(curr),[]);\n    this.uniques = {};\n    this._aggrKeys.forEach((key) => this.uniques[key] = new Set(this.datas.map((el)=>el[key]).filter((el)=>!!el)));\n  }\n\n  static _gatherAggrData(layer, aggrKeys) {\n    const aggrData = {\n      aggr: {},\n      data: []\n    };\n\n    // Collect datasets and aggregates\n    layer.eachLayer(function(obj, l) {\n      let result = {};\n      aggrKeys.forEach(function(key) {\n        result[key] = obj.feature.properties[key]\n        if (!aggrData.aggr[key]) {\n          aggrData.aggr[key] = {};\n        }\n        let group = aggrData.aggr[key];\n        if (result[key] && 'number' === typeof result[key]) {\n          if (!group.max || group.max < result[key]) {\n            group.max = result[key];\n          }\n          if (!group.min || group.min > result[key]) {\n            group.min = result[key];\n          }\n        }\n      });\n      aggrData.data.push(result);\n    });\n\n    return aggrData;\n  }\n}\n\nexport const ignoredKeys = [\n  'Site_Code',\n  'Data_Type',\n  'SiteName',\n  'Site_Name',\n  'Wid',\n  'ID',\n  'County'\n];\nexport const keyLookup = {\n  'Site_Name': {title: 'Name', desc: ''},\n  'Wid': {title: 'WGNHS ID', desc: ''},\n  'WID': {title: 'WGNHS ID', desc: ''},\n  'RecentLog': {title: 'Most recent log (year)', desc: ''},\n  'MaxDepth': {title: 'Max depth (ft)', desc: ''},\n  'Norm_Res': {title: 'Normal Resistivity', desc: ''},\n  'Caliper': {title: 'Caliper', desc: ''},\n  'Gamma': {title: 'Natural Gamma', desc: ''},\n  'SP': {title: 'Spontaneous (Self) Potential', desc: ''},\n  'SPR': {title: 'Single Point Resistivity', desc: ''},\n  'Spec_Gamma': {title: 'Spectral Gamma', desc: ''},\n  'Fluid_Cond': {title: 'Fluid Conductivity', desc: ''},\n  'Flow_Spin': {title: 'Spinner Flow Meter', desc: ''},\n  'Flow_HP': {title: 'HeatPulse Flow Meter', desc: ''},\n  'Fluid_Temp': {title: 'Fluid Temperature', desc: ''},\n  'Fluid_Res': {title: 'Fluid Resistivity', desc: ''},\n  'OBI': {title: 'Optical Borehole Image (OBI)', desc: ''},\n  'ABI': {title: 'Acoustic Borehole Image (ABI)', desc: ''},\n  'Video': {title: 'Video', desc: ''},\n  'Field_ID': {title: 'Field ID', desc: ''},\n  'Project': {title: 'Project', desc: ''},\n  'Drill_Year': {title: 'Drill year', desc: ''},\n  'Depth_Ft': {title: 'Depth (ft)', desc: ''},\n  'Drill_Method': {title: 'Drill Method', desc: ''},\n  'Subsamples': {title: 'Subsamples', desc: ''},\n  'Photos': {title: 'Core Photos', desc: ''},\n  'Grainsize': {title: 'Grainsize', desc: ''},\n  'Age_Data': {title: 'Age data', desc: ''},\n  'Proxy_Data': {title: 'Proxy data', desc: ''},\n};\n\nexport const filterLookup = [\n  new FilterGroup({\n    title: \"Site information\",\n    open: true,\n    sections: [\n      {\n        fields: {\n          \"County\": {\n            controls: [\n              new SelectControl()\n            ]\n          },\n          \"Site_Name\": {\n            controls: [\n              new ContainsControl()\n            ]\n          },\n          \"Wid\": {\n            controls: [\n              new TextControl()\n            ]\n          },\n        }\n      }\n    ]\n  }),\n  new FilterGroup({\n    title: \"Geophysical Log data\",\n    prop: 'Data_Type',\n    'Data_Type': 'geophysical log',\n    source: {\n      geojson: 'https://data.wgnhs.wisc.edu/arcgis/rest/services/geologic_data/borehole_geophysics/MapServer/0/query?where=1%3D1&inSR=4326&outFields=*&returnGeometry=true&geometryPrecision=6&outSR=4326&f=geojson',\n      user: 'https://data.wgnhs.wisc.edu/arcgis/rest/services/geologic_data/borehole_geophysics/MapServer/0'\n    },\n    color: 'var(--map-symbol-0)',\n    toggleable: true,\n    active: true,\n    sections: [\n      {\n        fields: {\n          \"RecentLog\": {\n            controls: [\n              new GTLTControl(true)\n            ]\n          },\n          \"MaxDepth\": {\n            controls: [\n              new GTLTControl()\n            ]\n          }\n        }\n      },\n      {\n        title: \"Geologic\",\n        bundled: true,\n        fields: {\n          \"Norm_Res\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Caliper\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Gamma\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"SP\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"SPR\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Spec_Gamma\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n\n        }\n      },\n      {\n        title: \"Hydrogeologic\",\n        bundled: true,\n        fields: {\n          \"Fluid_Cond\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Flow_Spin\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Fluid_Temp\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Fluid_Res\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Flow_HP\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n\n        }\n      },\n      {\n        title: \"Image\",\n        bundled: true,\n        fields: {\n          \"OBI\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"ABI\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Video\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n\n        }\n      }\n    ]\n  }),\n  new FilterGroup({\n    title: \"Quaternary Core data\",\n    prop: 'Data_Type',\n    'Data_Type': 'quaternary core',\n    source: {\n      geojson: 'https://data.wgnhs.wisc.edu/arcgis/rest/services/geologic_data/sediment_core/MapServer/0/query?where=1%3D1&inSR=4326&outFields=*&returnGeometry=true&geometryPrecision=6&outSR=4326&f=geojson',\n      user: 'https://data.wgnhs.wisc.edu/arcgis/rest/services/geologic_data/sediment_core/MapServer/0'\n    },\n    color: 'var(--map-symbol-1)',\n    toggleable: true,\n    active: true,\n    sections: [\n      {\n        fields: {\n          \"Drill_Year\": {\n            controls: [\n              new GTLTControl(true)\n            ]\n          },\n          \"Project\": {\n            controls: [\n              new SelectControl()\n            ]\n          },\n          \"Depth_Ft\": {\n            controls: [\n              new GTLTControl()\n            ]\n          },\n          \"Drill_Method\": {\n            controls: [\n              new SelectControl()\n            ]\n          },\n        }\n      },\n      {\n        title: \"Analyses available\",\n        bundled: true,\n        fields: {\n          \"Subsamples\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Photos\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Grainsize\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Age_Data\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          }\n        }\n      }\n    ]\n  })\n];","\nexport const RestylingCircleMarker = L.CircleMarker.extend({\n  getEvents: function() {\n    return {\n      zoomend: this._restyle,\n      filterpoints: this._filter\n    }\n  }, \n  _restyle: function(e){\n    this.setRadius(RestylingCircleMarker.calcRadius(e.target.getZoom()))\n  },\n  _filter: function(e) {\n    let isDisplayable = e.detail.resolve(this.feature.properties);\n    if (isDisplayable) {\n      this.setStyle({\n        stroke: true,\n        fill: true\n      })\n    } else {\n      this.setStyle({\n        stroke: false,\n        fill: false\n      })\n    }\n  },\n  highlight: function() {\n    this._activeBackup = {\n      color: this.options.color,\n      stroke: this.options.stroke,\n      fill: this.options.fill\n    };\n    this.setStyle({\n      color: 'var(--map-symbol-active)',\n      stroke: true,\n      fill: true\n    })\n  },\n  removeHighlight: function() {\n    if (this._activeBackup) {\n      this.setStyle(this._activeBackup);\n      this._activeBackup = null;\n    }\n  }\n});\n\nRestylingCircleMarker.calcRadius = (a) => Math.max(Math.floor(a/1.5),3);","import { filterLookup } from '../site-data.js';\nimport { RestylingCircleMarker } from './restyling-circle-marker.js';\n\nexport class SiteMap extends window.L.Evented {\n  constructor() {\n    super();\n    this.selected = false;\n    this._highlight = null;\n\n    /* ~~~~~~~~ Map ~~~~~~~~ */\n    //create a map, center it, and set the zoom level. \n    //set zoomcontrol to false because we will add it in a different corner. \n    this.map = L.map('map', {zoomControl:false}).setView([44.25, -89.9], 7);\n    this.el = document.querySelector('#map');\n     \n     /* ~~~~~~~~ Zoom Control ~~~~~~~~ */\n    //place a zoom control in the top right: \n    new L.Control.Zoom({position: 'topright'}).addTo(this.map);\n\n     \n    /* ~~~~~~~~ Basemap Layers ~~~~~~~~ */\n     \n    // // basemaps from Open Street Map\n    // const osmhot = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {\n    //   attribution: '&copy; <a href=\"https://osm.org/copyright\">OpenStreetMap</a> contributors', \n    //   label: \"OpenStreetMap Humanitarian\"\n    // });\n\n    // // CARTO Positron\n    // const positron = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {\n    //   attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n    //   label: 'CARTO Positron'\n    // });\n\n    // CARTO Voyager\n    const voyager = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png', {\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      label: 'CARTO Voyager'\n    });\n\n    // Esri basemaps \n    const esrisat = L.esri.basemapLayer('Imagery', {label: \"Esri Satellite\"});\n    \n    // add the basemap control to the map  \n    var basemaps = [voyager, esrisat]; \n    basemaps[0].addTo(this.map);\n    this.map.addControl(L.control.basemaps({\n       basemaps: basemaps, \n       tileX: 0, \n       tileY: 0, \n       tileZ: 1\n    })); \n\n    this.sources = filterLookup.reduce((result, curr) => {\n      if (curr.source && curr.source.geojson) {\n        result.push(\n          window.fetch(curr.source.geojson,{\n            cache: 'no-store'\n          })\n          .then((res) => {\n            return res.json()\n          }, reason => {\n            console.log(reason)\n          })\n          .then((geojson)=>({\n            name: curr[curr.prop],\n            color: curr.color,\n            data: geojson}), reason => {\n              console.log(reason)\n            }))\n      }\n      return result;\n    }, []);\n  }\n\n  init() {\n    const map = this.map;\n    return Promise.all(this.sources).then((responses) => {\n      this.layers = responses.map((res) => {\n        return L.geoJSON(res.data, {\n          name: res.name,\n          pointToLayer: function(geoJsonPoint, latlon) {\n            return new RestylingCircleMarker(latlon, {\n              weight: 2,\n              color: res.color,\n              radius: RestylingCircleMarker.calcRadius(map.getZoom()),\n              stroke: false,\n              fill: false\n            });\n          }\n        });\n      });\n      this.layers.forEach(l => l.on('click', (e) => {\n        if (this._highlight !== e.propagatedFrom) {\n          this.fire('interaction', e.propagatedFrom.feature.properties);\n        } else {\n          this.fire('interaction');\n        }\n      }))\n      this.layers.forEach(l => l.addTo(this.map));\n      let lookup = {};\n      this.layers.forEach(function(layer, idx, arr) {\n        layer.eachLayer(function(obj) {\n          let wid = obj.feature.properties['Wid'] || obj.feature.properties['WGNHS_ID'];\n          let siteCode = SiteMap.getSiteCode(obj.feature.properties);\n          let siteName = obj.feature.properties['Site_Name'] || obj.feature.properties['SiteName'];\n          let latLon = obj.getLatLng();\n          let cache = lookup[siteCode] || {\n            'Site_Code': siteCode,\n            'Site_Name': siteName,\n            'Wid': wid,\n            'Latitude': latLon['lat'].toFixed(6),\n            'Longitude': latLon['lng'].toFixed(6),\n            point: obj,\n            datas: new Array(arr.length)\n          };\n          obj.feature.properties['Site_Code'] = siteCode;\n          obj.feature.properties['Site_Name'] = siteName;\n          obj.feature.properties['Data_Type'] = layer.options.name;\n\n          cache.datas[idx] = obj.feature.properties;\n          lookup[siteCode] = cache;\n        });\n      });\n      this._lookup = lookup;\n    }, reason => console.log(reason));\n  }\n\n  static getSiteCode(params) {\n    let keys = ['Wid', 'WGNHS_ID', 'ID', 'Site_Code'];\n    let result = keys.reduce((prev, curr) => {\n      return prev || params[curr];\n    }, undefined)\n    return result;\n  }\n\n  //TODO HACK\n  getPoint(params) {\n    let result = null;\n    let cache = this._lookup[SiteMap.getSiteCode(params)];\n    if (cache) {\n      result = cache.point;\n    }\n    return result;\n  }\n\n  getSite(params) {\n    let result = this._lookup[SiteMap.getSiteCode(params)];\n    return result;\n  }\n\n  zoomToPoint(site) {\n    let point = this.getPoint(site);\n    if (point) {\n      this.map.setZoomAround(point.getLatLng(), 15);\n    }\n  }\n\n  getHighlightPoint() {\n    // console.log('retrieve highlight point');\n    let result = this._highlight;\n    return result;\n  }\n\n  setHighlightPoint(point) {\n    if (point) {\n      // console.log('set highlight point');\n      this._highlight = point;\n      this._highlight.bringToFront()\n      this._highlight.highlight();\n    } else {\n      this.clearSelection();\n    }\n  }\n\n  selectPoint(params) {\n    let result = null;\n    // console.log('select point on map:', site);\n    let point = this.getPoint(params);\n    if (point) {\n      result = point.feature.properties;\n      let highlightPoint = this.getHighlightPoint();\n      if (point !== highlightPoint) {\n        this.clearSelection();\n        this.setHighlightPoint(point);\n      }\n    }\n    return result;\n  }\n\n  selectSite(params) {\n    let result = this.getSite(params);\n    this.selectPoint(params);\n    return result;\n  }\n\n  clearSelection() {\n    // console.log('clear highlight group');\n    if (this._highlight) {\n      this._highlight.bringToBack();\n      this._highlight.removeHighlight();\n    }\n    this._highlight = null;\n  }\n\n  updatePoints(activePoints) {\n    this.map.fire('filterpoints', {\n      detail: {\n        resolve: (props) => {\n          return activePoints.reduce((prev, activeSet) => {\n            const code = SiteMap.getSiteCode(props);\n            const has = activeSet.has('' + code);\n            const result = prev || has;\n            return result;\n          }, false);\n        }\n      }\n    });\n  }\n\n  setVisibility(isVisible) {\n    if (isVisible) {\n      this.el.removeAttribute('data-closed');\n      this.map.invalidateSize();\n    } else {\n      this.el.setAttribute('data-closed', true);\n    }\n  }\n\n}","import { LitElement, html, css } from 'lit-element';\nimport { genId } from 'wgnhs-common';\nimport { ignoredKeys, keyLookup } from '../../site-data.js';\n\nexport class TableLayout extends LitElement {\n\n  static get layoutName() {\n    return undefined;\n  }\n\n  static include(info, context) {\n    return html`<table-layout .info=${info} .context=${context}></table-layout>`;\n  }\n\n  static get properties() {\n    return {\n      info: {\n        type: Object\n      },\n      context: {\n        type: Object\n      }\n    };\n  }\n\n  constructor() {\n    super();\n    this.genId = (function() {\n      const memo = {};\n      return function(index) {\n        if (!memo[index]) {\n          memo[index] = genId();\n        }\n        return memo[index];\n      }\n    })();\n  }\n\n  static get styles() {\n    return css`\n      [data-element=\"table\"] {\n        display: grid;\n        grid-template-columns: 40% 1fr;\n        grid-gap: var(--border-radius);\n        margin: 0 var(--border-radius);\n      }\n      .label {\n        font-weight: var(--font-weight-bold);\n      }\n    `;\n  }\n\n  render() {\n    let key = 0, value = 1;\n    let entries = Object.entries(this.info).filter((el) => {\n      return !ignoredKeys.includes(el[key]);\n    }).filter((el) => {\n      return !!el[value];\n    }).map((el, index) => html`\n      <dt class=\"label\" title=\"${(keyLookup[el[key]])?keyLookup[el[key]].desc:el[key]}\">\n        <label for=\"${this.genId(index)}\" >\n          ${(keyLookup[el[key]])?keyLookup[el[key]].title:el[key]}\n        </label>\n      </dt>\n      <dd class=\"detail\" title=\"${(keyLookup[el[key]])?keyLookup[el[key]].desc:el[key]}\">\n        <span id=\"${this.genId(index)}\">\n          ${el[value]}\n        </span>\n      </dd>\n    `);\n    return html`\n      <dl data-element=\"table\">\n        ${entries}\n      </dl>\n    `;\n  }\n}\ncustomElements.define('table-layout', TableLayout);\n","import { LitElement, html, css } from 'lit-element';\nimport { styles } from 'wgnhs-common';\n\n/**\n * https://stackoverflow.com/questions/10420352/converting-file-size-in-bytes-to-human-readable-string\n * @param {*} a \n * @param {*} b \n * @param {*} c \n * @param {*} d \n * @param {*} e \n */\nconst fileSizeIEC = function(a,b,c,d,e){\n  return (b=Math,c=b.log,d=1024,e=c(a)/c(d)|0,a/b.pow(d,e)).toFixed(2)\n  +' '+(e?'KMGTPEZY'[--e]+'iB':'Bytes')\n }\n\nexport class DownloadButton extends LitElement {\n  static get properties() {\n    return {\n      src: {\n        type: String\n      },\n      exists: {\n        type: Boolean,\n        reflect: true\n      },\n      fileSize: {\n        type: String,\n        attribute: false\n      }\n    };\n  }\n\n  constructor() {\n    super();\n  }\n\n  static get styles() {\n    return [\n      ...styles,\n      css`\n      [data-closed] {\n        display: none;\n      }\n      .file-size {\n        font-size: var(--font-size-small);\n      }\n    `];\n  }\n\n  render() {\n    return html`\n    <button-link href=\"${this.src}\" target=\"_blank\" download>\n      <i slot=\"content-before\" class=\"material-icons\" title=\"Download\">save_alt</i>\n      <span slot=\"content\"><slot name=\"label\">Download</slot></span>\n      <span slot=\"content-after\" class=\"file-size\"><slot name=\"detail\">${this.fileSize}</slot></span>\n    </button-link>\n    `;\n  }\n\n  updated(prev) {\n    if (prev.has('src') && this.src) {\n      this.exists = false;\n      window.fetch(this.src, {\n        method: 'HEAD',\n        cache: 'no-store'\n      }).then(resp => {\n        if (resp.ok) {\n          this.exists = true;\n          let bytes = resp.headers.get('Content-Length');\n          if (bytes) {\n            this.fileSize = fileSizeIEC(bytes);\n          }\n        }\n      });\n    }\n  }\n}\ncustomElements.define('download-button', DownloadButton);","import { LitElement, html, css } from 'lit-element';\nimport { styles } from 'wgnhs-styles';\nexport { AppCollapsible } from 'wgnhs-layout';\nexport { DownloadButton } from './download-button.js';\n\nconst TOGGLE_EVENT = 'toggle-pdf-panel';\n\nexport class PDFSplitButton extends LitElement {\n  static get properties() {\n    return {\n      src: {\n        type: String\n      },\n      panel: {\n        type: Object,\n        attribute: false\n      },\n      closed: {\n        type: Boolean,\n        attribute: false\n      }\n    };\n  }\n\n  constructor() {\n    super();\n    this.closed=true;\n  }\n\n  static get styles() {\n    return [\n      ...styles,\n      css`\n      .container {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        grid-gap: var(--border-radius);\n      }\n\n      .dl-button:not([exists]), .dl-button:not([exists]) + .view-button {\n        visibility: hidden;\n      }\n      `\n    ];\n  }\n\n  render() {\n    return html`\n    <div class=\"container\">\n      <download-button class=\"dl-button\" src=\"${this.src}\">\n        <span slot=\"label\"><slot name=\"download-text\">Download</slot></span>\n        <span slot=\"detail\"></span>\n      </download-button>\n      <app-collapsible class=\"view-button\" @open=\"${this.toggle}\" button>\n        <span slot=\"header\"><slot name=\"view-text\">View</slot></span>\n        <i slot=\"header-after\" class=\"material-icons\" title=\"View\">${\n          (this.alt)?'chevron_left':'chevron_right'\n        }</i>\n      </app-collapsible>\n    </div>\n    `;\n  }\n\n  updated(prev) {\n    if ((prev.has('panel') || prev.has('src'))) {\n      if (this.panel && this.src) {\n        this.panel.request(this.src)\n      }\n    }\n  }\n\n  toggle(e) {\n    if (!this.closed) {\n      this.panel.hide();\n    } else {\n      this.panel.show(this.src);\n    }\n  }\n\n  handleAlt(e) {\n    if (e.detail.url === this.src) {\n      this.closed = false;\n    } else {\n      this.closed = true;\n    }\n    this.requestUpdate();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.__altHandler = this.handleAlt.bind(this);\n    document.addEventListener(TOGGLE_EVENT, this.__altHandler);\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener(TOGGLE_EVENT, this.__altHandler);\n    super.disconnectedCallback();\n  }\n}\ncustomElements.define('pdf-split-button', PDFSplitButton);\n","import { LitElement, html, css } from 'lit-element';\nimport { filterLookup, keyLookup } from '../../site-data.js';\nexport { DownloadButton } from '../download-button.js';\nexport { PDFSplitButton } from '../pdf-split-button.js';\n\nexport class LogLayout extends LitElement {\n  static get layoutName() {\n    return 'geophysical log';\n  }\n\n  static include(info, context) {\n    return html`<log-layout .info=${info} .context=${context}></log-layout>`;\n  }\n\n  static get properties() {\n    return {\n      info: {\n        type: Object\n      },\n      context: {\n        type: Object\n      }\n    };\n  }\n\n  constructor() {\n    super();\n  }\n\n  static get styles() {\n    return css`\n      .dl-las:not([exists]) {\n        visibility: hidden;\n      }\n    `;\n  }\n\n  render() {\n    return html`\n    <table-layout .info=${this.prepInfo()} .context=${this.context}></table-layout>\n    <pdf-split-button\n      .panel=${this.context.pdfpanel}\n      src=\"${'https://data.wgnhs.wisc.edu/borehole-geophysics/pdf/' + this.info.Wid + '.pdf'}\">\n      <span slot=\"download-text\">Download PDF</span>\n    </pdf-split-button>\n    <download-button\n      class=\"dl-las\"\n      src=\"${'https://data.wgnhs.wisc.edu/borehole-geophysics/las/' + this.info.Wid + '.las'}\">\n      <span slot=\"label\">Download LAS</span>\n    </download-button>\n    `;\n  }\n\n  prepInfo() {\n    return Object.assign(this.topFields, this.bottomFields);\n  }\n\n  get topFields() {\n    return this.getFields(el => !el.bundled);\n  }\n\n  get bottomFields() {\n    const fields = this.getFields(el => el.bundled);\n    const names = Object.entries(fields)\n      .filter(kv => !!kv[1])\n      .map(kv => (keyLookup[kv[0]])?keyLookup[kv[0]].title:kv[0]);\n    return {\n      'Data available:': names.map(val => html`${val}<br>`)\n    };\n  }\n\n  get group() {\n    return filterLookup.find(el => (el.prop && el[el.prop] === this.info[el.prop]));\n  }\n\n  getFields(fn) {\n    const result = {};\n    const sections = this.group.sections.filter(fn);\n  \n    sections.forEach(section => {\n      Object.entries(section.fields).forEach(kv => {\n        result[kv[0]] = this.info[kv[0]];\n      })\n    });\n  \n    return result;\n  }\n}\ncustomElements.define('log-layout', LogLayout);\n","import { LitElement, html, css } from 'lit-element';\nimport { filterLookup, keyLookup } from '../../site-data.js';\n\nexport class CoreLayout extends LitElement {\n  static get layoutName() {\n    return 'quaternary core';\n  }\n\n  static include(info, context) {\n    return html`<core-layout .info=${info} .context=${context}></core-layout>`;\n  }\n\n  static get properties() {\n    return {\n      info: {\n        type: Object\n      },\n      context: {\n        type: Object\n      }\n    };\n  }\n\n  constructor() {\n    super();\n  }\n\n  static get styles() {\n    return css`\n    `;\n  }\n  render() {\n    return html`\n    <table-layout .info=${this.prepInfo()}></table-layout>\n    `;\n  }\n\n  prepInfo() {\n    return Object.assign(this.topFields, this.bottomFields);\n  }\n\n  get topFields() {\n    return this.getFields(el => !el.bundled);\n  }\n\n  get bottomFields() {\n    const fields = this.getFields(el => el.bundled);\n    let names = Object.entries(fields)\n      .filter(kv => !!kv[1])\n      .map(kv => (keyLookup[kv[0]])?keyLookup[kv[0]].title:kv[0])\n      .map(val => html`${val}<br>`);\n    if (names.length < 1) {\n      names = null;\n    }\n    return {\n      'Analyses available:': names\n    };\n  }\n\n  get group() {\n    return filterLookup.find(el => (el.prop && el[el.prop] === this.info[el.prop]));\n  }\n\n  getFields(fn) {\n    const result = {};\n    const sections = this.group.sections.filter(fn);\n  \n    sections.forEach(section => {\n      Object.entries(section.fields).forEach(kv => {\n        result[kv[0]] = this.info[kv[0]];\n      })\n    });\n  \n    return result;\n  }\n}\ncustomElements.define('core-layout', CoreLayout);\n","import { TableLayout } from './layout/table-layout.js';\nimport { LogLayout } from './layout/log-layout.js';\nimport { CoreLayout } from './layout/core-layout.js';\n\n\nconst defaultLayout = TableLayout;\nconst availableLayouts = [\n  defaultLayout,\n  LogLayout,\n  CoreLayout\n];\n\nexport const layoutResolver = {\n  getLayout: function getLayout(layoutName) {\n    let layout = availableLayouts.find((el) => {\n      return el.layoutName === layoutName;\n    });\n    if (!layout) {\n      layout = defaultLayout;\n    }\n    return layout.include;\n  }\n}","import { LitElement, html, css } from 'lit-element';\nimport { styles } from 'wgnhs-styles';\nimport { dispatch } from 'wgnhs-common';\nexport { PDFViewButton } from 'wgnhs-pdf';\nimport { layoutResolver } from './layout-resolver.js';\n\nexport class SiteDetails extends LitElement {\n  static get properties() {\n    return {\n      siteinfo: {\n        type: Object\n      },\n      pdfpanel: {\n        type: Object\n      }\n    };\n  }\n\n  constructor() {\n    super();\n\n  }\n\n  static get styles() {\n    return [\n      ...styles,\n      css`\n      .header {\n        position: -webkit-sticky;\n        position: sticky;\n        top: 0px;\n        background-color: var(--palette-white);\n        padding: var(--font-size-extra-large) var(--border-radius);\n        z-index: 10;\n        width: 100%;\n        box-sizing: border-box;\n        display: flex;\n        justify-content: space-between;\n      }\n      .header h1 {\n        padding: 0;\n        max-width: 70%;\n        text-align: center;\n      }\n      .header i {\n        font-size: var(--icon-size-large);\n        color: var(--palette-accent);\n        cursor: pointer;\n      }\n\n      .name {\n        text-transform: capitalize;\n      }\n\n      [data-closed] {\n        display: none;\n      }\n    `];\n  }\n\n  renderData(info, layoutName) {\n    const layout = layoutResolver.getLayout(layoutName);\n    return layout(info, this);\n  }\n\n  render() {\n    let Latitude = (this.siteinfo)?this.siteinfo['Latitude']:null;\n    let Longitude = (this.siteinfo)?this.siteinfo['Longitude']:null;\n    let WID = (this.siteinfo)?this.siteinfo['Wid']:null;\n    return html`\n      ${(!this.siteinfo)? '' : html`\n        <div class=\"header\">\n          <span>\n            <a href=\"${window.router.link('entry')}\" onclick=\"event.preventDefault()\"><i class=\"material-icons clear-selection\" title=\"Clear selection\" @click=\"${this.fireClearSelection}\" >arrow_back</i></a>\n          </span>\n          <h1>${this.siteinfo.Site_Name}</h1>\n          <span>\n            <i class=\"material-icons zoom-to-site\" title=\"Zoom to site\" @click=\"${this.fireZoomToSite}\">my_location</i>\n          </span>\n        </div>\n        ${this.renderData({\n          Latitude, Longitude, WID\n        })}\n        ${this.siteinfo.datas.map((props) => html`\n          <app-collapsible open>\n            <span slot=\"header\" class=\"name\">${props['Data_Type']}</span>\n            <div slot=\"content\">\n              ${this.renderData(props, props['Data_Type'])}\n            </div>\n          </app-collapsible>\n        `)}\n      `}\n    `;\n  }\n\n  fireClearSelection() {\n    dispatch(this, 'clear-selection', {}, true, true);\n  }\n\n  fireZoomToSite() {\n    dispatch(this, 'zoom-to-site', {params: this.siteinfo}, true, true);\n  }\n}\ncustomElements.define('site-details', SiteDetails);","import { LitElement, html, css } from 'lit-element';\n\nexport class FilterSummary extends LitElement {\n  static get properties() {\n    return {\n      counts: {\n        type: Array,\n        attribute: false\n      }\n    };\n  }\n\n  constructor() {\n    super();\n  }\n\n  static get styles() {\n    return css`\n    li[disabled] {\n      color: var(--palette-dark);\n    }\n    .name {\n      text-transform: capitalize;\n    }\n    `;\n  }\n\n  render() {\n    return (!this.counts)?html``:html`\n    <div>\n      <span>Showing\n        ${this.counts.reduce((prev, count) => (count.current + prev), 0)}\n        of\n        ${this.counts.reduce((prev, count) => (count.total + prev), 0)}\n        total sites\n      </span>\n      <ul>\n        ${this.counts.map((el) => html`\n        <li ?disabled=${!el.included}>\n          ${el.current} of ${el.total} <span class=\"name\">${el.name}</span> sites\n          ${(el.filteredBy.length > 0)?html`\n          (filtered by ${el.filteredBy.join(', ')})\n          `:''}\n        </li>\n        `)}\n      </ul>\n    </div>\n    `;\n  }\n\n  handleFiltered(e) {\n    if (e.detail) {\n      this.counts = e.detail.counts;\n    }\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.__filteredHandler = this.handleFiltered.bind(this);\n    document.addEventListener('filtered', this.__filteredHandler);\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('filtered', this.__filteredHandler);\n    super.disconnectedCallback();\n  }\n}\ncustomElements.define('filter-summary', FilterSummary);","import { LitElement, html, css } from 'lit-element';\nimport { genId, dispatch } from 'wgnhs-common';\nexport { InRadio, ToggleSwitch } from 'wgnhs-layout';\nexport { AppCollapsible } from 'wgnhs-layout';\nimport { styles } from 'wgnhs-styles';\nexport { FilterSummary } from './filter-summary.js';\nimport { keyLookup, filterLookup } from '../site-data.js';\nimport { SiteMap } from '../map/site-map.js';\n\nexport class MapFilter extends LitElement {\n  static get properties() {\n    return {\n      include: {\n        type: Array,\n        attribute: false\n      },\n      filter: {\n        type: Array,\n        attribute: false\n      },\n      matchClass: {\n        type: String,\n        attribute: false\n      },\n      sources: {\n        type: Array,\n        attribute: false\n      }\n    };\n  }\n\n  static get styles() {\n    return [\n      ...styles,\n      css`\n      .field {\n        display: grid;\n        grid-template-columns: 40% 1fr;\n        grid-gap: var(--border-radius);\n        margin: 0 var(--border-radius);\n      }\n\n      .label {\n        font-weight: var(--font-weight-bold);\n      }\n\n      .selector {\n      }\n\n      .section-title {\n        margin: var(--line-height) 0 0 0;\n        padding: var(--border-radius);\n        background-color: var(--palette-light);\n      }\n\n      in-radio {\n        display: inline-grid;\n        grid-template-columns: auto auto;\n      }\n    `];\n  }\n\n  updateMatchClass(e) {\n    this.matchClass = e.target.choice;\n  }\n\n  render() {\n    return html`\n      <div>\n        Show sites that have <in-radio choices='[\"ALL\", \"ANY\"]' @choice-change=\"${this.updateMatchClass}\"></in-radio> of the following:\n      </div>\n      <div>\n        ${this.renderFilterGroups()}\n      </div>\n    `;\n  }\n\n  resolveKeyLookup(field) {\n    let result = (!keyLookup[field])?field:keyLookup[field].title;\n    return result;\n  }\n\n  renderFilterGroups() {\n    let name=0, config=1;\n    return this.filterGroups.map((group) => html`\n      <app-collapsible\n        ?open=${group.open} @open=${this._handle(group)}>\n        <i slot=\"header-before\" class=\"material-icons\">expand_more</i>\n        <span slot=\"header\">${group.title}</span>\n        ${(!group.toggleable)?'':html`\n          <toggle-switch\n            name=\"${group.title}\"\n            slot=\"header-after\"\n            ?checked=${group.active}\n            @change=${this._handleGroup(group, 'include')}\n            style=\"--palette-active: ${group.color}\"\n          ></toggle-switch>\n        `}\n        <div slot=\"content\">\n          ${group.sections.map((section, index) => html`\n            ${!(section.title)?'':html`\n              <h2 class=\"section-title\">${section.title}</h2>\n            `}\n            ${Object.entries(section.fields).map((entry, index) => html`\n              <div class=\"field\">\n              ${(entry[config].controls.length === 0)?'':entry[config].controls.map(control => html`\n                <td class=\"label\">\n                  <label for=\"${this.genId(index)}\" >\n                    ${this.resolveKeyLookup(entry[name])}\n                  </label>\n                </td>\n                <td class=\"selector\" \n                    @change=\"${this._handleControl(group, control, 'filter')}\">\n                  <input\n                    type=\"hidden\"\n                    id=\"${control.id}\"\n                    name=\"${entry[name]}\">\n                  ${control.next}\n                </td>\n              `)}\n              </div>\n            `)}\n          `)}\n        </div>\n      </app-collapsible>\n    `);\n  }\n\n  get _eventHandlers() {\n    return {\n      'open' : (context, e) => {\n        context.open = e.detail.value;\n      }\n    }\n  }\n\n  _handle(context) {\n    return (e) => {\n      const handler = this._eventHandlers[e.type];\n      if (handler) {\n        handler(context, e);\n        this.requestUpdate('handle_'+e.type);\n      }\n    }\n  }\n\n  _handleGroup(group, type) {\n    const id = group.id;\n    const handle = group.activate.bind(group);\n    const filter = this[type];\n    const callback = this.requestUpdate.bind(this);\n    return (e) => {\n      const context = {};\n      context.id = id;\n      context.toggleable = group.toggleable;\n      context.detail = e.detail;\n      context.prop = group.prop;\n      context.value = group[group.prop];\n      removeFromFilter(filter, id);\n      let resolver = handle(context);\n      if (resolver) {\n        filter.push(resolver);\n      }\n      callback(type);\n    }\n  }\n\n  _handleControl(group, control, type) {\n    const id = control.id;\n    const handle = control.handle.bind(control);\n    const filter = this[type];\n    const callback = this.requestUpdate.bind(this);\n    return (e) => {\n      const context = {};\n      context.id = id;\n      context.group = group;\n      context.target = e.currentTarget.querySelector('#'+id);\n      context.prop = context.target.name;\n      removeFromFilter(filter, id);\n      let resolver = handle(context);\n      if (resolver) {\n        filter.push(resolver);\n      }\n      callback(type);\n    }\n  }\n\n  updated(changed) {\n    const isNeeded = (\n      changed.has('matchClass') ||\n      changed.has('include') ||\n      changed.has('filter') ||\n      changed.has('sources'));\n\n    if (this.sources && isNeeded) {\n      const activePoints = MapFilter.runFilter({\n        matchClass: this.matchClass,\n        incl: this.include,\n        filt: this.filter,\n        sources: this.sources\n      });\n      const counts = MapFilter.getResultsInfo(\n        this.matchClass,\n        this.include,\n        this.filter,\n        this.sources,\n        activePoints\n        );\n      dispatch(this, 'filtered', {activePoints, counts}, true, true);\n    }\n  }\n\n  init(uniques, layers) {\n    this.filterGroups.forEach((group) => {\n      group.sections.forEach((section) => {\n        Object.entries(section.fields).forEach((field) => {\n          field[1].controls.forEach((control) => {\n            if (control.init) {\n              control.init(uniques[field[0]]);\n            }\n          })\n        })\n      })\n    });\n\n    this.sources = layers;\n  }\n\n  static runFilter({matchClass, incl, filt, sources}) {\n    const resolve = function runPointThroughFilters(props) {\n      let included = incl.length > 0 && incl.reduce((prev, curr) => {\n        return prev || curr.resolve(props);\n      }, false);\n      let spec = filt.filter((rule) => rule.resolveGroup(props));\n      let result = included && spec.length < 1;\n      if (included && !result) {\n        if (\"ALL\" === matchClass) {\n          result = spec.reduce((prev, curr) => {\n            return prev && curr.resolve(props);\n          }, true);\n        } else {\n          result = spec.reduce((prev, curr) => {\n            return prev || curr.resolve(props);\n          }, false);\n        }\n      }\n      return result;\n    }\n\n    const result = sources.map((layer) => {\n      const activePoints = new Set();\n      Object.entries(layer._layers).forEach((ent) => {\n        if (resolve(ent[1].feature.properties)) {\n          activePoints.add('' + SiteMap.getSiteCode(ent[1].feature.properties));\n        }\n      });\n      return activePoints;\n    });\n\n    return result;\n  }\n\n  static getResultsInfo(matchClass, include, filter, sources, activePoints) {\n    const result = sources.map((layer, i) => {\n      let stats = {};\n      stats.name = layer.options.name;\n      stats.included = include.some((el) => {\n        return el.context.value === layer.options.name;\n      });\n      stats.filteredBy = filter.reduce((result, el) => {\n        if (el.context.group[el.context.group.prop] === layer.options.name) {\n          result.push((keyLookup[el.context.prop])?keyLookup[el.context.prop].title:el.context.prop);\n        }\n        return result;\n      }, []);\n      stats.matchClass = matchClass;\n\n      let entries = Object.entries(layer._layers);\n      stats.total = entries.length;\n      stats.current = activePoints[i].size;\n\n      return stats;\n    });\n    return result;\n  }\n\n  constructor() {\n    super();\n    this.genId = (function() {\n      const memo = {};\n      return function(index) {\n        if (!memo[index]) {\n          memo[index] = genId();\n        }\n        return memo[index];\n      }\n    })();\n    this.include = [];\n    this.filter = [];\n    this.filterGroups = filterLookup;\n  }\n}\ncustomElements.define('map-filter', MapFilter);\n\nconst removeFromFilter = (filter, id) => {\n  for (\n    var idx = filter.findIndex(el => el.id === id); \n    idx >= 0;\n    idx = filter.findIndex(el => el.id === id)\n  ) {\n    filter.splice(idx, 1);\n  }\n}\n\n","import { SiteMap } from './map/site-map.js';\nimport { SiteData } from './site-data.js';\nimport { SiteRouter } from 'wgnhs-router';\nexport { SiteDetails } from './details/site-details.js';\nexport { MapFilter } from './filter/map-filter.js';\n\nwindow.siteMap = new SiteMap();\nwindow.sidebar = document.querySelector('#sidebar');\nwindow.pdfPanel = document.querySelector('#sketch');\ndocument.querySelectorAll('site-details').forEach(function(details) {\n  details['pdfpanel'] = window.pdfPanel;\n});\nwindow.filter = document.querySelector('#filter');\n\nwindow.siteMap.init().then(function() {\n  window.siteData = new SiteData(window.siteMap.layers);\n  window.aggrData = siteData.aggrData;\n  filter.init(window.siteData.uniques, window.siteMap.layers);\n\n  var deselectFeature = function() {\n    window.pdfPanel.hide();\n    document.querySelectorAll('site-details').forEach(function(details) {\n      details['siteinfo'] = null;\n    });\n  }\n\n  async function selectFeature(info) {\n    deselectFeature();\n    document.querySelectorAll('site-details').forEach(function(details) {\n      details['siteinfo'] = info;\n    });\n    return true;\n  };\n\n  window.router = new SiteRouter();\n  window.router.addRoute({\n    name: 'entry',\n    url: '/',\n    onEnter: function(trans, state) {\n      // console.log('route-entry');\n      window.siteMap.clearSelection();\n      deselectFeature();\n      document.querySelector('#app').setAttribute('data-view', 'app');\n      window.sidebar.switchTab('default');\n      window.siteMap.setVisibility(true);\n    },\n    onExit: function(trans, state) {\n\n    },\n  });\n  window.router.addRoute({\n    name: 'view',\n    url: '/view/:Site_Code',\n    // params: {\n    //   'Site_Code': {\n    //     array: true\n    //   }\n    // },\n    onEnter: function(trans, state) {\n      // console.log('route-view');\n      let params = trans.params();\n      let attr = window.siteMap.selectSite(params);\n      if (attr) {\n        document.querySelectorAll('site-details').forEach(function(details) {\n          details['printLayout'] = false;\n        });\n        selectFeature(attr).then(() => {\n          document.querySelector('#app').setAttribute('data-view', 'app');\n          window.sidebar.switchTab('details');\n          window.siteMap.setVisibility(true);\n        })\n      } else {\n        window.router.clearRoute();\n      }\n    },\n    onExit: function(trans, state) {\n\n    },\n  });\n  window.router.addRoute({\n    name: 'print',\n    url: '/print/:Site_Code',\n    // params: {\n    //   'Site_Code': {\n    //     array: true\n    //   }\n    // },\n    onEnter: function(trans, state) {\n      // console.log('route-print');\n      let params = trans.params();\n      let attr = window.siteMap.selectSite(params);\n      if (attr) {\n        document.querySelectorAll('site-details').forEach(function(details) {\n          details['printLayout'] = true;\n        });\n        selectFeature(attr).then(() => {\n          document.querySelector('#app').removeAttribute('data-view');\n          window.sidebar.switchTab('details');\n          window.siteMap.setVisibility(false);\n        })\n      } else {\n        window.router.clearRoute();\n      }\n    },\n    onExit: function(trans, state) {\n\n    },\n  });\n  window.router.router.transitionService.onEnter({}, ()=>{\n    document.querySelector('#spinner').setAttribute('data-closed', true);\n  });\n  // Start the router\n  window.router.start();\n\n  window.siteMap.on('interaction', (params) => {\n    if (params['Site_Code']) {\n      window.router.setRoute('view', params);\n    } else {\n      window.router.clearRoute();\n    }\n  });\n});\n\ndocument.addEventListener('clear-selection', function(e) {\n  window.router.clearRoute();\n});\n\ndocument.addEventListener('zoom-to-site', function(e) {\n  window.siteMap.zoomToPoint(e.detail.params);\n})\n\ndocument.addEventListener('toggle-print', function(e) {\n  if (e.detail.on) {\n    window.router.setRoute('print', e.detail.params);\n  } else {\n    window.router.setRoute('view', e.detail.params);\n  }\n});\n\ndocument.addEventListener('toggle-pdf-panel', function(e) {\n  window.siteMap.setVisibility(e.detail.closed);\n  if (e.detail.closed) {\n    window.pdfPanel.setAttribute('data-closed', true);\n  } else {\n    window.pdfPanel.removeAttribute('data-closed');\n  }\n});\n\ndocument.addEventListener('filtered', function(e) {\n  window.siteMap.updatePoints(e.detail.activePoints);\n});"],"names":["FilterGroup","[object Object]","config","Object","assign","this","id","genId","context","result","input","detail","checked","toggleable","resolve","feature","prop","value","CheckboxControl","next","html","target","nextElementSibling","resolveGroup","group","GTLTControl","isDate","gtName","eqName","ltName","a","b","predicate","isValid","SelectControl","options","map","el","uniques","Array","from","sort","SiteData","layers","_aggrKeys","aggrData","l","push","_gatherAggrData","datas","data","reduce","prev","curr","concat","forEach","key","Set","filter","layer","aggrKeys","aggr","eachLayer","obj","properties","max","min","ignoredKeys","keyLookup","Site_Name","title","desc","Wid","WID","RecentLog","MaxDepth","Norm_Res","Caliper","Gamma","SP","SPR","Spec_Gamma","Fluid_Cond","Flow_Spin","Flow_HP","Fluid_Temp","Fluid_Res","OBI","ABI","Video","Field_ID","Project","Drill_Year","Depth_Ft","Drill_Method","Subsamples","Photos","Grainsize","Age_Data","Proxy_Data","filterLookup","open","sections","fields","County","controls","trim","toUpperCase","includes","Data_Type","source","geojson","user","color","active","bundled","RestylingCircleMarker","L","CircleMarker","extend","getEvents","zoomend","_restyle","filterpoints","_filter","e","setRadius","calcRadius","getZoom","setStyle","stroke","fill","highlight","_activeBackup","removeHighlight","Math","floor","SiteMap","window","Evented","super","selected","_highlight","zoomControl","setView","document","querySelector","Control","Zoom","position","addTo","basemaps","tileLayer","attribution","label","esri","basemapLayer","addControl","control","tileX","tileY","tileZ","sources","fetch","cache","then","res","json","reason","console","log","name","Promise","all","responses","geoJSON","pointToLayer","geoJsonPoint","latlon","weight","radius","on","propagatedFrom","fire","lookup","idx","arr","wid","siteCode","getSiteCode","siteName","latLon","getLatLng","Site_Code","Latitude","toFixed","Longitude","point","length","_lookup","params","undefined","site","getPoint","setZoomAround","bringToFront","clearSelection","getHighlightPoint","setHighlightPoint","getSite","selectPoint","bringToBack","activePoints","props","activeSet","code","has","isVisible","removeAttribute","invalidateSize","setAttribute","TableLayout","LitElement","layoutName","info","type","memo","index","styles","css","entries","customElements","define","fileSizeIEC","c","d","pow","src","String","exists","Boolean","reflect","fileSize","attribute","method","resp","ok","bytes","headers","get","TOGGLE_EVENT","panel","closed","toggle","request","show","hide","url","requestUpdate","connectedCallback","__altHandler","handleAlt","bind","addEventListener","removeEventListener","disconnectedCallback","LogLayout","prepInfo","pdfpanel","topFields","bottomFields","getFields","Data available:","kv","val","find","fn","section","CoreLayout","names","Analyses available:","defaultLayout","availableLayouts","layoutResolver","getLayout","layout","include","SiteDetails","siteinfo","router","link","fireClearSelection","fireZoomToSite","renderData","dispatch","counts","count","current","total","included","filteredBy","join","__filteredHandler","handleFiltered","MapFilter","matchClass","choice","updateMatchClass","renderFilterGroups","field","filterGroups","_handle","_handleGroup","entry","resolveKeyLookup","_handleControl","_eventHandlers","handler","handle","activate","callback","removeFromFilter","resolver","currentTarget","changed","isNeeded","runFilter","incl","filt","getResultsInfo","init","_layers","ent","spec","rule","add","i","stats","some","size","findIndex","splice","siteMap","sidebar","pdfPanel","querySelectorAll","details","siteData","deselectFeature","async","selectFeature","SiteRouter","addRoute","onEnter","trans","state","switchTab","setVisibility","onExit","attr","selectSite","clearRoute","transitionService","start","setRoute","zoomToPoint","updatePoints"],"mappings":"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"}