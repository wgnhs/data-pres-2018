!(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lit-element"),require("@uirouter/core")):"function"==typeof define&&define.amd?define(["exports","lit-element","@uirouter/core"],t):t((e=e||self).index={},e.common,e.common)})(this,function(e,t,i){"use strict";class r extends t.LitElement{static get properties(){return{}}constructor(){super()}static get styles(){return t.css`.loader{color:var(--palette-900);font-size:90px;text-indent:-9999em;overflow:hidden;width:1em;height:1em;border-radius:50%;margin:72px auto;position:relative;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0);-webkit-animation:load6 1.7s infinite ease,round 1.7s infinite ease;animation:load6 1.7s infinite ease,round 1.7s infinite ease}@-webkit-keyframes load6{0%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}5%,95%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}10%,59%{box-shadow:0 -.83em 0 -.4em,-.087em -.825em 0 -.42em,-.173em -.812em 0 -.44em,-.256em -.789em 0 -.46em,-.297em -.775em 0 -.477em}20%{box-shadow:0 -.83em 0 -.4em,-.338em -.758em 0 -.42em,-.555em -.617em 0 -.44em,-.671em -.488em 0 -.46em,-.749em -.34em 0 -.477em}38%{box-shadow:0 -.83em 0 -.4em,-.377em -.74em 0 -.42em,-.645em -.522em 0 -.44em,-.775em -.297em 0 -.46em,-.82em -.09em 0 -.477em}100%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}}@keyframes load6{0%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}5%,95%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}10%,59%{box-shadow:0 -.83em 0 -.4em,-.087em -.825em 0 -.42em,-.173em -.812em 0 -.44em,-.256em -.789em 0 -.46em,-.297em -.775em 0 -.477em}20%{box-shadow:0 -.83em 0 -.4em,-.338em -.758em 0 -.42em,-.555em -.617em 0 -.44em,-.671em -.488em 0 -.46em,-.749em -.34em 0 -.477em}38%{box-shadow:0 -.83em 0 -.4em,-.377em -.74em 0 -.42em,-.645em -.522em 0 -.44em,-.775em -.297em 0 -.46em,-.82em -.09em 0 -.477em}100%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}}@-webkit-keyframes round{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes round{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}`}render(){return t.html`<div class=loader>Loading...</div>`}}customElements.define("app-spinner",r);class o extends t.LitElement{static get properties(){return{title:{type:String},tabs:{type:Array}}}constructor(){super()}static get styles(){return t.css`:host{padding:0 var(--border-radius)}`}switchTab(e){this.shadowRoot.querySelectorAll("slot").forEach(t=>{"default"===e&&!t.getAttribute("name")||t.getAttribute("name")===e?t.hidden=!1:t.hidden=!0})}handleChoiceChange(e){this.switchTab(e.detail.choice)}render(){return t.html`<style>@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);@import url(https://fonts.googleapis.com/icon?family=Material+Icons);body{font-family:var(--font-family);font-size:var(--font-size);line-height:var(--line-height);background-color:var(--palette-white)}body,h1,h2,h3,h4,h5,p{color:var(--palette-black);font-family:var(--font-family);padding:0;margin:0;box-sizing:border-box}h1,h2,h3,h4,h5{padding:.25rem 0 .75rem 0;font-weight:var(--font-weight-bold)}h1{font-size:var(--font-size-extra-large);color:var(--palette-accent)}h2{font-size:var(--font-size-large)}p{line-height:1.4rem;margin:0 0 1rem 0}a{color:var(--palette-900);cursor:pointer;text-decoration-line:underline;text-decoration-style:dashed;text-decoration-color:var(--palette-900)}</style>${this.title?t.html`<h1 class=header>${this.title}</h1>`:""}<slot></slot>${this.tabs?this.tabs.map(e=>t.html`<slot name=${e} hidden></slot>`):""}`}}function n(){return"_"+Math.random().toString(36).substr(2,9)}function a(e,t,i,r,o){e.dispatchEvent(new CustomEvent(t,{bubbles:r,composed:o,detail:i}))}customElements.define("app-sidebar",o);class s{constructor(e){Object.assign(this,e),this.id||(this.id=n())}activate(e){let t=null;const i=e.detail.checked;return e.toggleable&&i&&(t={id:e.id,resolve:function(t){return t[e.prop]===e.value}}),t}}class l{constructor(){this.id=n()}get next(){return t.html`<input type=checkbox>`}handle(e){let t=null;return e.target.nextElementSibling.checked&&(t={id:e.id,resolveGroup:function(t){return!e.group.prop||e.group[e.group.prop]===t[e.group.prop]},resolve:function(t){return!!t[e.prop]}}),t}}class c{constructor(e){this.id=n(),this.gtName=e?"after":"at least",this.ltName=e?"before":"less than"}get next(){return t.html`<select><option value=gt>${this.gtName}</option><option value=lt>${this.ltName}</option></select> <input type=text>`}handle(e){let t=null;e.gt=((e,t)=>e>=t),e.lt=((e,t)=>e<t);const i=e[e.target.nextElementSibling.value],r=e.target.nextElementSibling.nextElementSibling.value;return r&&(t={id:e.id,resolveGroup:function(t){return!e.group.prop||e.group[e.group.prop]===t[e.group.prop]},resolve:function(t){let o=!!t[e.prop];return o&&(o=i(t[e.prop],r)),o}}),t}}class d{constructor(){this.id=n()}get next(){return t.html`<select ?disabled=${!this.options}><option></option>${this.options?this.options.map(e=>t.html`<option value=${e}>${e}</option>`):""}</select>`}init(e){this.options||(this.options=Array.from(e).sort())}handle(e){let t=null;const i=e.target.nextElementSibling.value;return i&&(t={id:e.id,resolveGroup:function(t){return!e.group.prop||e.group[e.group.prop]===t[e.group.prop]},resolve:function(t){let r=!!t[e.prop];if(r){r=t[e.prop]===i}return r}}),t}}const h=["Site_Code","Data_Type","SiteName","Site_Name","Wid","ID"],p={SiteName:{title:"Site Name",desc:""},Site_Name:{title:"Site Name",desc:""},Wid:{title:"WID",desc:""},ID:{title:"ID",desc:""},RecentLog:{title:"Most recent log (year)",desc:""},MaxDepth:{title:"Max depth (ft)",desc:""},Norm_Res:{title:"Normal Resistivity",desc:""},Caliper:{title:"Caliper",desc:""},Gamma:{title:"Natural Gamma",desc:""},SP:{title:"Spontaneous (Self) Potential",desc:""},SPR:{title:"Single Point Resistivity",desc:""},Spec_Gamma:{title:"Spectral Gamma",desc:""},Fluid_Cond:{title:"Fluid Conductivity",desc:""},Flow_Spin:{title:"Spinner Flow Meter",desc:""},Fluid_Temp:{title:"Fluid Temperature",desc:""},Fluid_Res:{title:"Fluid Resistivity",desc:""},OBI:{title:"Optical Borehole Image (OBI)",desc:""},ABI:{title:"Acoustic Borehole Image (ABI)",desc:""},Video:{title:"Video",desc:""},Drill_Year:{title:"Drill year",desc:""},Depth_Ft:{title:"Depth (ft)",desc:""},Drill_Meth:{title:"Drill Method",desc:""},Subsamples:{title:"Subsamples",desc:""},Photos:{title:"Core Photos",desc:""},Grainsize:{title:"Grainsize",desc:""}},m=[new s({title:"Site Information",open:!0,sections:[{fields:{County:{controls:[new d]},Site_Name:{controls:[new class{constructor(){this.id=n()}get next(){return t.html`<input type=text>`}handle(e){let t=null;const i=(""+e.target.nextElementSibling.value).trim().toUpperCase();return i&&(t={id:e.id,resolveGroup:function(t){return!e.group.prop||e.group[e.group.prop]===t[e.group.prop]},resolve:function(t){let r=!!t[e.prop];return r&&(r=(""+t[e.prop]).trim().toUpperCase().includes(i)),r}}),t}}]},Wid:{controls:[new class{constructor(){this.id=n()}get next(){return t.html`<input type=text>`}handle(e){let t=null;const i=(""+e.target.nextElementSibling.value).trim().toUpperCase();return i&&(t={id:e.id,resolveGroup:function(t){return!e.group.prop||e.group[e.group.prop]===t[e.group.prop]},resolve:function(t){let r=!!t[e.prop];return r&&(r=(""+t[e.prop]).trim().toUpperCase()===i),r}}),t}}]}}}]}),new s({title:"Geophysical Log Data",prop:"Data_Type",Data_Type:"Geophysical Log Data",toggleable:!0,active:!0,sections:[{fields:{RecentLog:{controls:[new c(!0)]},MaxDepth:{controls:[new c]}}},{title:"Geologic",fields:{Norm_Res:{controls:[new l]},Caliper:{controls:[new l]},Gamma:{controls:[new l]},SP:{controls:[new l]},SPR:{controls:[new l]},Spec_Gamma:{controls:[new l]}}},{title:"Hydrogeologic",fields:{Fluid_Cond:{controls:[new l]},Flow_Spin:{controls:[new l]},Fluid_Temp:{controls:[new l]},Fluid_Res:{controls:[new l]},Flow_HP:{controls:[new l]}}},{title:"Image",fields:{OBI:{controls:[new l]},ABI:{controls:[new l]},Video:{controls:[new l]}}}]}),new s({title:"Quaternary Core Data",prop:"Data_Type",Data_Type:"Quaternary Core Data",toggleable:!0,active:!0,sections:[{fields:{Drill_Year:{controls:[new c(!0)]},Depth_Ft:{controls:[new c]},Drill_Meth:{controls:[new d]}}},{title:"Analyses available",fields:{Subsamples:{controls:[new l]},Photos:{controls:[new l]},Grainsize:{controls:[new l]}}}]})];customElements.define("app-collapsible",class extends t.LitElement{static get properties(){return{genId:{type:String,attribute:!1},open:{type:Boolean,reflect:!0},button:{type:Boolean}}}constructor(){super(),this.genId=n()}static get styles(){return t.css`.wrap-collapsible{margin:var(--border-radius) 0}input[type=checkbox]{display:none}.lbl-toggle{display:block;font-weight:var(--font-weight-bold);font-size:var(--font-size-extra-large);text-align:center;padding:var(--border-radius);color:var(--palette-accent);background:var(--palette-light);cursor:pointer;border-radius:var(--border-radius);transition:all .3s cubic-bezier(.755,.05,.855,.06)}.lbl-toggle:hover{color:var(--palette-900)}.lbl-toggle:focus{outline:thin dotted}.collapsible-content{max-height:0;overflow:hidden;transition:max-height .3s cubic-bezier(.86,0,.07,1)}.wrap-collapsible:not([button]) .toggle:checked~.collapsible-content{max-height:var(--collapsible-max-height,3000px)}.wrap-collapsible:not([button]) .toggle:checked~.lbl-toggle{border-bottom-right-radius:0;border-bottom-left-radius:0;transition:border 0s}.collapsible-content .content-inner{background:var(--palette-white);border-bottom:1px solid var(--palette-light);border-right:1px solid var(--palette-light);border-left:1px solid var(--palette-light);border-bottom-left-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);padding:var(--font-size)}.collapsible-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between}`}render(){return t.html`<div class=wrap-collapsible ?button=${this.button}><input id=${this.genId} class=toggle type=checkbox ?checked=${this.open} @change=${this._handleChange}> <label for=${this.genId} class=lbl-toggle tabindex=0><div class=collapsible-header><div><slot name=header-before></slot></div><div><slot name=header></slot></div><div><slot name=header-after></slot></div></div></label><div class=collapsible-content><div class=content-inner><slot name=content></slot></div></div></div>`}firstUpdated(){let e=this.renderRoot.querySelectorAll(".lbl-toggle");Array.from(e).forEach(e=>{e.addEventListener("keydown",t=>{32!==t.which&&13!==t.which||(t.preventDefault(),e.click())})})}updated(e){e.has("open")&&a(this,"open",{value:this.open})}_handleChange(e){this.open=e.target.checked}});customElements.define("button-link",class extends t.LitElement{static get properties(){return{href:{type:String},target:{type:String},download:{type:Boolean}}}constructor(){super()}static get styles(){return t.css`a{text-decoration:none;margin:var(--border-radius) 0}.button-link:hover{color:var(--palette-900)}.button-link:focus{outline:thin dotted}.button-link{display:block;font-weight:var(--font-weight-bold);font-size:var(--font-size-extra-large);text-align:center;cursor:pointer;text-align:center;background:var(--palette-light);color:var(--palette-accent);border-radius:var(--border-radius);padding:var(--border-radius)}.wrap-content{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.icon{font-size:var(--icon-size-extra-large)}`}render(){return t.html`<a class=button-link href=${this.href} target=${this.target} ?download=${this.download}><div class=wrap-content><div><slot name=content-before></slot></div><div><slot name=content></slot></div><div><slot name=content-after></slot></div></div></a>`}});let u=window["pdfjs-dist/build/pdf"];const g="toggle-pdf-panel";class f{render(e){if(e){let t=document.createElement("canvas");return u.getDocument(e).promise.then(function(e){return e.getPage(1)}).then(function(e){var i=e.getViewport({scale:1}),r=t,o=r.getContext("2d");r.height=i.height,r.width=i.width;var n={canvasContext:o,viewport:i};return e.render(n).promise}).then(function(){return t.toDataURL()})}return Promise.reject(null)}}class b extends t.LitElement{static get properties(){return{imgsrc:{type:String,attribute:!1}}}constructor(){super(),this.cache={},this.renderer=new f}static get styles(){return t.css`:host{overflow:auto}.container{min-height:10em;display:flex;align-items:center;justify-content:center}.content{max-width:45vw}.controls{display:grid;grid-column-template:1fr;grid-gap:var(--border-radius);position:absolute;top:0;right:var(--border-radius);margin:var(--border-radius);z-index:10}.control{font-size:var(--icon-size-large);color:var(--palette-accent);text-align:center;cursor:pointer;padding:var(--border-radius);background-color:var(--palette-light);border-radius:50%}`}render(){return t.html`<style>@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);@import url(https://fonts.googleapis.com/icon?family=Material+Icons);body{font-family:var(--font-family);font-size:var(--font-size);line-height:var(--line-height);background-color:var(--palette-white)}body,h1,h2,h3,h4,h5,p{color:var(--palette-black);font-family:var(--font-family);padding:0;margin:0;box-sizing:border-box}h1,h2,h3,h4,h5{padding:.25rem 0 .75rem 0;font-weight:var(--font-weight-bold)}h1{font-size:var(--font-size-extra-large);color:var(--palette-accent)}h2{font-size:var(--font-size-large)}p{line-height:1.4rem;margin:0 0 1rem 0}a{color:var(--palette-900);cursor:pointer;text-decoration-line:underline;text-decoration-style:dashed;text-decoration-color:var(--palette-900)}</style><div class=controls><i class="material-icons control" title=Hide @click=${this.hide}>close</i></div><div class=container>${this.imgsrc?t.html`<img class=content src=${this.imgsrc}>`:""}</div>`}show(e){this.dispatchEvent(new CustomEvent(g,{bubbles:!0,composed:!0,detail:{url:e,closed:!1}})),this.imgsrc=this.cache[e],this.removeAttribute("data-closed")}hide(){this.imgsrc=null,this.setAttribute("data-closed",!0),this.dispatchEvent(new CustomEvent(g,{bubbles:!0,composed:!0,detail:{closed:!0}}))}_getFromCache(e){return new Promise((t,i)=>{let r=this.cache[e];r?t(r):i("Not in cache")})}request(e){return this._getFromCache(e).catch(()=>this.renderer.render(e).then(t=>(this.cache[e]=t,t)))}}customElements.define("pdf-view-panel",b);customElements.define("pdf-view-button",class extends t.LitElement{static get properties(){return{src:{type:String},panel:{type:Object,attribute:!1},missing:{type:Boolean,attribute:!1}}}constructor(){super(),this.missing=!0,this.alt=!1}static get styles(){return t.css`.container{display:grid;grid-template-columns:1fr 1fr;grid-gap:var(--border-radius)}[data-closed]{display:none}`}render(){return t.html`<style>@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);@import url(https://fonts.googleapis.com/icon?family=Material+Icons);body{font-family:var(--font-family);font-size:var(--font-size);line-height:var(--line-height);background-color:var(--palette-white)}body,h1,h2,h3,h4,h5,p{color:var(--palette-black);font-family:var(--font-family);padding:0;margin:0;box-sizing:border-box}h1,h2,h3,h4,h5{padding:.25rem 0 .75rem 0;font-weight:var(--font-weight-bold)}h1{font-size:var(--font-size-extra-large);color:var(--palette-accent)}h2{font-size:var(--font-size-large)}p{line-height:1.4rem;margin:0 0 1rem 0}a{color:var(--palette-900);cursor:pointer;text-decoration-line:underline;text-decoration-style:dashed;text-decoration-color:var(--palette-900)}</style><div class=container ?data-closed=${this.missing}><button-link href=${this.src} target=_blank download><i slot=content-before class=material-icons title=Download>save_alt</i> <span slot=content>Download</span></button-link><app-collapsible @open=${this.toggle} button><span slot=header>View</span> <i slot=header-after class=material-icons title=View>${this.alt?"chevron_left":"chevron_right"}</i></app-collapsible></div>`}updated(e){(e.has("panel")||e.has("src"))&&(this.handleMissingPDF(),this.panel&&this.src&&this.panel.request(this.src).then(this.handleLoadedPDF.bind(this),this.handleMissingPDF.bind(this)))}toggle(e){this.alt?this.panel.hide():this.panel.show(this.src)}handleMissingPDF(){this.missing||(this.missing=!0)}handleLoadedPDF(){this.missing&&(this.missing=!1)}handleAlt(e){e.detail.url===this.src?this.alt=!0:this.alt=!1,this.requestUpdate()}connectedCallback(){super.connectedCallback(),this.__altHandler=this.handleAlt.bind(this),document.addEventListener(g,this.__altHandler)}disconnectedCallback(){document.removeEventListener(g,this.__altHandler),super.disconnectedCallback()}});class v extends t.LitElement{static get properties(){return{siteinfo:{type:Object},pdfpanel:{type:Object}}}constructor(){super(),this.genId=(function(){const e={};return function(t){return e[t]||(e[t]=n()),e[t]}})()}static get styles(){return t.css`[data-element=table]{display:grid;grid-template-columns:40% 1fr;grid-gap:var(--border-radius);margin:0 var(--border-radius)}.label{font-weight:var(--font-weight-bold)}.header{position:-webkit-sticky;position:sticky;top:0;background-color:var(--palette-white);padding:var(--font-size-extra-large);z-index:10;width:100%;box-sizing:border-box;display:flex;justify-content:space-between}.header h1{padding:0;max-width:70%;text-align:center}.header i{font-size:var(--icon-size-large);color:var(--palette-accent);cursor:pointer}[data-closed]{display:none}`}renderTable(e){return Object.entries(e).filter((e,t)=>!h.includes(e[0])).map((e,i)=>t.html`<td class=label title=${p[e[0]]?p[e[0]].desc:e[0]}><label for=${this.genId(i)}>${p[e[0]]?p[e[0]].title:e[0]}</label></td><td class=detail title=${p[e[0]]?p[e[0]].desc:e[0]}><span id=${this.genId(i)}>${e[1]}</span></td>`)}render(){let e=this.siteinfo?this.siteinfo.Latitude:null,i=this.siteinfo?this.siteinfo.Longitude:null,r=this.siteinfo?this.siteinfo.Wid:null;return t.html`<style>@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);@import url(https://fonts.googleapis.com/icon?family=Material+Icons);body{font-family:var(--font-family);font-size:var(--font-size);line-height:var(--line-height);background-color:var(--palette-white)}body,h1,h2,h3,h4,h5,p{color:var(--palette-black);font-family:var(--font-family);padding:0;margin:0;box-sizing:border-box}h1,h2,h3,h4,h5{padding:.25rem 0 .75rem 0;font-weight:var(--font-weight-bold)}h1{font-size:var(--font-size-extra-large);color:var(--palette-accent)}h2{font-size:var(--font-size-large)}p{line-height:1.4rem;margin:0 0 1rem 0}a{color:var(--palette-900);cursor:pointer;text-decoration-line:underline;text-decoration-style:dashed;text-decoration-color:var(--palette-900)}</style>${this.siteinfo?t.html`<div class=header><span><a href=${window.router.link("entry")} onclick=event.preventDefault()><i class="material-icons clear-selection" title="Clear selection" @click=${this.fireClearSelection}>arrow_back</i></a></span><h1>${this.siteinfo.Site_Name}</h1><span></span></div><div data-element=table>${this.renderTable({Latitude:e,Longitude:i,WID:r})}</div><h2>Data Available:</h2>${this.siteinfo.datas.map(e=>t.html`<app-collapsible open><span slot=header>${e.Data_Type}</span><div slot=content><div data-element=table>${this.renderTable(e)}</div>${e.Wid?t.html`<pdf-view-button .panel=${this.pdfpanel} src=${"https://data.wgnhs.wisc.edu/geophysical-logs/"+e.Wid+".pdf"}></pdf-view-button>`:""}</div></app-collapsible>`)}`:""}`}fireClearSelection(){let e=new CustomEvent("clear-selection",{bubbles:!0,detail:{}});this.dispatchEvent(e)}}customElements.define("site-details",v);customElements.define("in-radio",class extends t.LitElement{static get properties(){return{inName:{type:String,attribute:"in-name"},choices:{type:Array},choice:{type:String,reflect:!0}}}constructor(){super(),this.checked=[],this.genId=(function(){const e={};return function(t){return e[t]||(e[t]=n()),e[t]}})()}firstUpdated(){!this.choice&&this.choices&&(this.choice=this.choices[0])}updated(){let e=new CustomEvent("choice-change",{detail:{choice:this.choice}});this.dispatchEvent(e)}inChange(e){this.choice=e.target.value}render(){return t.html`${this.choices.map((e,i)=>t.html`<div class=choice><input type=radio name=${this.inName} id=${this.genId(i)} value=${e} .checked=${this.choice===e} @change=${this.inChange}> <label for=${this.genId(i)}>${e}</label></div>`)}`}});customElements.define("toggle-switch",class extends t.LitElement{static get properties(){return{checked:{type:Boolean}}}constructor(){super(),this.id||(this.id=n())}static get styles(){return t.css`:host{display:flex;justify-content:center;align-items:center}input[type=checkbox]{height:0;width:0;margin:0;visibility:hidden}label{cursor:pointer;text-indent:-9999px;width:calc(2 * var(--icon-size));height:var(--icon-size);background:var(--palette-accent);display:block;border-radius:var(--icon-size);position:relative}label:after{content:'';position:absolute;top:calc(calc(var(--icon-size) - var(--icon-size-small))/ 2);left:calc(calc(var(--icon-size) - var(--icon-size-small))/ 2);width:var(--icon-size-small);height:var(--icon-size-small);background:var(--palette-white);border-radius:var(--icon-size-small);transition:.3s}input:checked+label{background:var(--palette-active)}input:checked+label:after{left:calc(100% - calc(calc(var(--icon-size) - var(--icon-size-small))/ 2));transform:translateX(-100%)}label:active:after{width:calc(var(--icon-size-small) + calc(calc(var(--icon-size) - var(--icon-size-small))/ 2))}`}render(){return t.html`<input type=checkbox id=switch .checked=${this.checked} @change=${this.handleChange}><label for=switch>Toggle</label>`}updated(e){e.has("checked")&&a(this,"change",{checked:this.checked},!0)}handleChange(e){this.checked=e.target.checked}toggle(){this.checked=!this.checked}});customElements.define("filter-summary",class extends t.LitElement{static get properties(){return{counts:{type:Array}}}constructor(){super()}static get styles(){return t.css``}render(){return this.counts?t.html`<div><span>Showing:</span><ul><li><span>${this.counts.reduce((e,t)=>t.current+e,0)} </span>of <span>${this.counts.reduce((e,t)=>t.total+e,0)} </span>total sites</li>${this.counts.map(e=>t.html`<li><span>${e.current}</span> of <span>${e.total}</span> sites having <span>${e.name}</span></li>`)}</ul></div>`:t.html``}setCounts(e){this.counts=e}});class y extends t.LitElement{static get properties(){return{include:{type:Array,attribute:!1},filter:{type:Array,attribute:!1},matchClass:{type:String,attribute:!1},sources:{type:Array,attribute:!1}}}static get styles(){return t.css`.field{display:grid;grid-template-columns:40% 1fr;grid-gap:var(--border-radius);margin:0 var(--border-radius)}.label{font-weight:var(--font-weight-bold)}.section-title{margin:var(--line-height) 0 0 0;padding:var(--border-radius);background-color:var(--palette-light)}in-radio{display:inline-grid;grid-template-columns:auto auto}`}updateMatchClass(e){this.matchClass=e.target.choice}render(){return t.html`<style>@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);@import url(https://fonts.googleapis.com/icon?family=Material+Icons);body{font-family:var(--font-family);font-size:var(--font-size);line-height:var(--line-height);background-color:var(--palette-white)}body,h1,h2,h3,h4,h5,p{color:var(--palette-black);font-family:var(--font-family);padding:0;margin:0;box-sizing:border-box}h1,h2,h3,h4,h5{padding:.25rem 0 .75rem 0;font-weight:var(--font-weight-bold)}h1{font-size:var(--font-size-extra-large);color:var(--palette-accent)}h2{font-size:var(--font-size-large)}p{line-height:1.4rem;margin:0 0 1rem 0}a{color:var(--palette-900);cursor:pointer;text-decoration-line:underline;text-decoration-style:dashed;text-decoration-color:var(--palette-900)}</style><div><filter-summary></filter-summary></div><div>Show sites that have<in-radio choices='["ALL", "ANY"]' @choice-change=${this.updateMatchClass}></in-radio>of the following:</div><div>${this.renderFilterGroups()}</div>`}resolveKeyLookup(e){return p[e]?p[e].title:e}renderFilterGroups(){return this.filterGroups.map(e=>t.html`<app-collapsible ?open=${e.open} @open=${this._handle(e)}><i slot=header-before class=material-icons>expand_more</i> <span slot=header>${e.title}</span> ${e.toggleable?t.html`<toggle-switch name=${e.mapName} slot=header-after ?checked=${e.active} @change=${this._handleGroup(e,"include")}></toggle-switch>`:""}<div slot=content>${e.sections.map((i,r)=>t.html`${i.title?t.html`<h2 class=section-title>${i.title}</h2>`:""} ${Object.entries(i.fields).map((i,r)=>t.html`<div class=field>${0===i[1].controls.length?"":i[1].controls.map(o=>t.html`<td class=label><label for=${this.genId(r)}>${this.resolveKeyLookup(i[0])}</label></td><td class=selector @change=${this._handleControl(e,o,"filter")}><input type=hidden id=${o.id} name=${i[0]}> ${o.next}</td>`)}</div>`)}`)}</div></app-collapsible>`)}get _eventHandlers(){return{open:(e,t)=>{e.open=t.detail.value}}}_handle(e){return t=>{const i=this._eventHandlers[t.type];i&&(i(e,t),this.requestUpdate("handle_"+t.type))}}_handleGroup(e,t){const i=e.id,r=e.activate.bind(e),o=this[t],n=this.requestUpdate.bind(this);return a=>{const s={};s.id=i,s.toggleable=e.toggleable,s.detail=a.detail,s.prop=e.prop,s.value=e[e.prop],w(o,i);let l=r(s);l&&o.push(l),n(t)}}_handleControl(e,t,i){const r=t.id,o=t.handle.bind(t),n=this[i],a=this.requestUpdate.bind(this);return t=>{const s={};s.id=r,s.group=e,s.target=t.currentTarget.querySelector("#"+r),s.prop=s.target.name,w(n,r);let l=o(s);l&&n.push(l),a(i)}}updated(e){const t=e.has("matchClass")||e.has("include")||e.has("filter")||e.has("sources");if(this.sources&&t){const e=y.runFilter({matchClass:this.matchClass,incl:this.include,filt:this.filter,sources:this.sources});this.$summary.setCounts(y.getResultsInfo(this.sources,e)),a(this,"filtered",{activePoints:e})}}firstUpdated(){this.$summary=this.renderRoot.querySelector("filter-summary")}init(e,t){this.filterGroups.forEach(t=>{t.sections.forEach(t=>{Object.entries(t.fields).forEach(t=>{t[1].controls.forEach(i=>{i.init&&i.init(e[t[0]])})})})}),this.sources=t}static runFilter({matchClass:e,incl:t,filt:i,sources:r}){return r.map(r=>{const o=new Set;return Object.entries(r._layers).forEach(r=>{(function(r){let o=t.length>0&&t.reduce((e,t)=>e||t.resolve(r),!1),n=i.filter(e=>e.resolveGroup(r)),a=o&&n.length<1;return o&&!a&&(a="ALL"===e?n.reduce((e,t)=>e&&t.resolve(r),!0):n.reduce((e,t)=>e||t.resolve(r),!1)),a})(r[1].feature.properties)&&o.add(""+r[0])}),o})}static getResultsInfo(e,t){return e.map((e,i)=>{let r={};r.name=e.options.name;let o=Object.entries(e._layers);return r.total=o.length,r.current=t[i].size,r})}constructor(){super(),this.genId=(function(){const e={};return function(t){return e[t]||(e[t]=n()),e[t]}})(),this.include=[],this.filter=[],this.filterGroups=m}}customElements.define("map-filter",y);const w=(e,t)=>{for(var i=e.findIndex(e=>e.id===t);i>=0;i=e.findIndex(e=>e.id===t))e.splice(i,1)};e.AppSidebar=o,e.AppSpinner=r,e.MapFilter=y,e.PDFViewPanel=b,e.SiteDetails=v,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.min.js.map
